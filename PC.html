<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Emulador Web de Windows</title>
  <script>
    // Usamos window.matchMedia para detectar un ancho menor a 768px
    if (window.matchMedia("(max-width: 768px)").matches) {
      alert("Esta web simula un entorno de escritorio y no está adaptada a móviles. Serás redirigido a nuestro CV.");
      window.location.href = "https://sergioivorra.github.io/cv";
    }
  </script>
  <link rel="stylesheet" href="style.css">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
  <style>
    /* Estilos generales */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      user-select: none;
    }
    body {
      font-family: 'Segoe UI', sans-serif;
      overflow: hidden;
      height: 100vh;
      background: #000;
    }
    /* Pantalla de bloqueo */
    #lock-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url('https://picsum.photos/1920/1080') center/cover;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      color: white;
      z-index: 1000;
      transition: transform 0.5s cubic-bezier(0.4,0,0.2,1);
      text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
    }
    #lock-screen.active {
      transform: translateY(0);
    }
    #lock-screen:not(.active) {
      transform: translateY(-100%);
    }
    .time {
      font-size: 84px;
      font-weight: 200;
      letter-spacing: 2px;
    }
    .date {
      font-size: 28px;
      margin-top: 10px;
      opacity: 0.9;
      text-transform: capitalize;
    }
    .swipe-up {
      position: absolute;
      bottom: 50px;
      display: flex;
      flex-direction: column;
      align-items: center;
      animation: bounce 2s infinite;
      opacity: 0.8;
      font-size: 16px;
      letter-spacing: 1px;
    }
    @keyframes bounce {
      0%,20%,50%,80%,100% { transform: translateY(0); }
      40% { transform: translateY(-20px); }
      60% { transform: translateY(-10px); }
    }
    /* Escritorio e iconos */
    #desktop {
      height: 100vh;
      background: linear-gradient(rgba(0,0,0,0.1), rgba(0,0,0,0.1)), url('https://picsum.photos/1920/1080') center/cover;
      position: relative;
      transition: filter 0.3s ease;
    }
    .desktop-blur {
      filter: blur(5px);
    }
    .desktop-icons {
      padding: 20px;
      display: grid;
      grid-template-columns: repeat(auto-fill, 90px);
      gap: 20px;
    }
    .icon {
      width: 90px;
      height: 100px;
      display: flex;
      flex-direction: column;
      align-items: center;
      color: white;
      text-align: center;
      cursor: pointer;
      padding: 8px;
      border-radius: 8px;
      transition: all 0.2s ease;
      text-shadow: 1px 1px 3px rgba(0,0,0,0.8);
    }
    .icon:hover {
      background: rgba(255,255,255,0.15);
      transform: scale(1.05);
    }
    .icon:active {
      transform: scale(0.95);
    }
    .icon i {
      font-size: 36px;
      margin-bottom: 8px;
      filter: drop-shadow(2px 2px 3px rgba(0,0,0,0.5));
    }
    .icon span {
      font-size: 13px;
      word-wrap: break-word;
      line-height: 1.2;
    }
    .icon[data-window="youtube"] i {
      text-shadow: 2px 2px 3px rgba(0,0,0,0.5);
    }
    .icon[data-window="youtube"]:hover i {
      filter: brightness(0.9);
    }
    .icon[data-window="n64"] i {
      color: #ffffff;
      transform: rotate(-10deg);
    }
    .icon[data-window="n64"]:hover i {
      animation: controller-pulse 1s infinite;
    }
    @keyframes controller-pulse {
      0% { transform: rotate(-10deg) scale(1); }
      50% { transform: rotate(-10deg) scale(1.1); }
      100% { transform: rotate(-10deg) scale(1); }
    }
    /* Barra de tareas */
    #taskbar {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 48px;
      background: rgba(0,0,0,0.85);
      backdrop-filter: blur(15px);
      display: flex;
      align-items: center;
      padding: 0 12px;
      color: white;
      box-shadow: 0 -1px 10px rgba(0,0,0,0.3);
    }
    .start-button {
      width: 48px;
      height: 48px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
      border-radius: 4px;
    }
    .start-button:hover {
      background: rgba(255,255,255,0.1);
    }
    .start-button i {
      font-size: 20px;
      color: #00a4ef;
    }
    .task-list {
      flex: 1;
      display: flex;
      margin: 0 12px;
      gap: 4px;
      overflow-x: auto;
    }
    .task-button {
      padding: 0 12px;
      height: 40px;
      display: flex;
      align-items: center;
      background: rgba(255,255,255,0.08);
      border-radius: 4px;
      cursor: pointer;
      transition: all 0.2s ease;
      white-space: nowrap;
    }
    .task-button:hover {
      background: rgba(255,255,255,0.15);
    }
    .task-button.active {
      background: rgba(255,255,255,0.2);
    }
    .system-tray {
      padding: 0 12px;
      display: flex;
      align-items: center;
      gap: 16px;
      height: 100%;
      border-left: 1px solid rgba(255,255,255,0.1);
    }
    .system-tray i {
      font-size: 14px;
      opacity: 0.8;
    }
    .system-tray .time {
      font-size: 14px;
      opacity: 0.9;
    }
    /* Menú de inicio */
    #start-menu {
      position: fixed;
      bottom: 48px;
      left: 0;
      width: 350px;
      height: 600px;
      background: rgba(32,32,32,0.95);
      backdrop-filter: blur(20px);
      color: white;
      padding: 20px;
      transform: translateY(100%);
      transition: transform 0.3s cubic-bezier(0.4,0,0.2,1);
      border-radius: 8px 8px 0 0;
      box-shadow: 0 -5px 20px rgba(0,0,0,0.3);
      overflow-y: auto;
    }
    #start-menu.show {
      transform: translateY(0);
    }
    .apps-list {
      display: grid;
      gap: 8px;
    }
    .app-item {
      display: flex;
      align-items: center;
      padding: 12px;
      cursor: pointer;
      border-radius: 6px;
      transition: all 0.2s ease;
    }
    .app-item:hover {
      background: rgba(255,255,255,0.1);
    }
    .app-item i {
      margin-right: 12px;
      width: 20px;
      font-size: 18px;
    }
    /* Ventanas */
    .window {
      position: absolute;
      background: rgba(255,255,255,0.98);
      border-radius: 8px;
      box-shadow: 0 5px 25px rgba(0,0,0,0.25);
      min-width: 320px;
      min-height: 220px;
      transition: all 0.3s ease;
      border: 1px solid rgba(0,0,0,0.2);
    }
    .window-header {
      background: #f3f3f3;
      padding: 8px 12px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      border-radius: 8px 8px 0 0;
      border-bottom: 1px solid rgba(0,0,0,0.1);
      cursor: move;
    }
    .window-title {
      margin-left: 8px;
      font-size: 14px;
      color: #333;
    }
    .window-controls {
      display: flex;
      gap: 4px;
    }
    .window-button {
      width: 28px;
      height: 28px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      border-radius: 4px;
      transition: all 0.2s ease;
    }
    .window-button:hover {
      background: rgba(0,0,0,0.08);
    }
    .window-button.close:hover {
      background: #e81123;
      color: white;
    }
    .window-content {
      padding: 16px;
      height: calc(100% - 45px);
      overflow: auto;
    }
    #game {
      width: 100% !important;
      height: 100% !important;
      background: #000;
    }
    .window[data-type="n64"],
    .window[data-type="mariokart"],
    .window[data-type="correo"],
    .window[data-type="settings"],
    .window[data-type="calculator"] {
      min-width: 800px;
      min-height: 600px;
    }
    .window[data-type="n64"] .window-content,
    .window[data-type="mariokart"] .window-content,
    .window[data-type="correo"] .window-content,
    .window[data-type="settings"] .window-content,
    .window[data-type="calculator"] .window-content {
      padding: 0;
      overflow: hidden;
      background: #1a1a1a;
    }
    #emulator {
      width: 100% !important;
      height: 100% !important;
      display: flex;
      justify-content: center;
      align-items: center;
      background: #000;
      color: #fff;
    }
    .loading-message {
      color: #fff;
      font-size: 18px;
      text-align: center;
    }
    #n64-game-select {
      min-width: 200px;
    }
    #start-game {
      background: #5a5a5a;
      font-weight: bold;
      transition: background-color 0.2s;
      padding: 8px 16px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      color: white;
    }
    #start-game:hover {
      background: #4a4a4a !important;
    }
    #start-game:disabled {
      opacity: 0.7;
      cursor: not-allowed;
    }
    #start-game:active {
      background: #3a3a3a !important;
    }
    .emulator-controls {
      position: absolute;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0,0,0,0.8);
      padding: 10px;
      border-radius: 8px;
      display: none;
    }
    .nav-buttons button {
      cursor: pointer;
      transition: background-color 0.2s;
      padding: 6px;
      border: none;
      background: #fff;
      border-radius: 4px;
      margin-right: 4px;
    }
    .nav-buttons button:hover {
      background-color: #e8e8e8 !important;
    }
    .nav-buttons button:active {
      background-color: #d8d8d8 !important;
    }
    .window-content input[type="text"] {
      font-family: inherit;
    }
    .window-content input[type="text"]:focus {
      outline: none;
      background: #f8f9fa;
    }
    /* Panel de Configuración (estilo moderno iPhone) */
    .settings-container {
      background: #f7f7f7;
      width: 100%;
      height: 100%;
      overflow-y: auto;
      padding: 20px;
    }
    .settings-header {
      font-size: 24px;
      font-weight: bold;
      margin-bottom: 20px;
      text-align: center;
      color: #333;
    }
    .setting-item {
      background: #fff;
      margin-bottom: 15px;
      padding: 15px 20px;
      border-radius: 12px;
      box-shadow: 0 1px 4px rgba(0,0,0,0.1);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .setting-item label {
      font-size: 16px;
      color: #333;
    }
    .setting-item input[type="checkbox"] {
      width: 40px;
      height: 20px;
      -webkit-appearance: none;
      background: #ccc;
      outline: none;
      border-radius: 20px;
      position: relative;
      cursor: pointer;
      transition: background 0.3s;
    }
    .setting-item input[type="checkbox"]:checked {
      background: #0078D7;
    }
    .setting-item input[type="checkbox"]::after {
      content: '';
      width: 18px;
      height: 18px;
      background: #fff;
      border-radius: 50%;
      position: absolute;
      top: 1px;
      left: 1px;
      transition: left 0.3s;
    }
    .setting-item input[type="checkbox"]:checked::after {
      left: 21px;
    }
    .setting-item select, .setting-item input[type="range"] {
      padding: 5px;
      font-size: 16px;
      border: 1px solid #ddd;
      border-radius: 8px;
      background: #fff;
      color: #333;
    }
    @media (max-width: 768px) {
      .time {
        font-size: 64px;
      }
      .date {
        font-size: 22px;
      }
      .desktop-icons {
        grid-template-columns: repeat(auto-fill, 70px);
        gap: 15px;
      }
      .icon {
        width: 70px;
        height: 80px;
      }
      .icon i {
        font-size: 28px;
      }
      .icon span {
        font-size: 11px;
      }
      #taskbar {
        height: 40px;
      }
      .start-button {
        width: 40px;
        height: 40px;
      }
      #start-menu {
        width: 100%;
        bottom: 40px;
        height: 500px;
      }
    }
  </style>
</head>
<body>
  <!-- Pantalla de bloqueo -->
  <div id="lock-screen" class="active">
    <div class="time"></div>
    <div class="swipe-up">
      <span>Desliza para desbloquear</span>
      <i class="fas fa-chevron-up" style="margin-top: 10px;"></i>
    </div>
  </div>
  
  <!-- Escritorio -->
  <div id="desktop">
    <div class="desktop-icons">
      <div class="icon" data-window="explorer">
        <i class="fas fa-folder"></i>
        <span>Explorador</span>
      </div>
      <div class="icon" data-window="notepad">
        <i class="fas fa-sticky-note"></i>
        <span>Bloc de Notas</span>
      </div>
      <div class="icon" data-window="calculator">
        <i class="fas fa-calculator"></i>
        <span>Calculadora</span>
      </div>
      <div class="icon" data-window="browser">
        <i class="fab fa-edge"></i>
        <span>Edge</span>
      </div>
      <div class="icon" data-window="youtube">
        <i class="fab fa-youtube" style="color: #ffffff;"></i>
        <span>YouTube</span>
      </div>
      <!-- Ícono de Correo -->
      <div class="icon" data-window="correo">
        <i class="fas fa-envelope"></i>
        <span>Correo</span>
      </div>
      <div class="icon" data-window="settings">
        <i class="fas fa-cog"></i>
        <span>Configuración</span>
      </div>
      <div class="icon" data-window="n64">
        <i class="fas fa-gamepad"></i>
        <span>Nintendo 64</span>
      </div>
      <!-- Redes sociales -->
      <div class="icon" data-window="instagram">
        <i class="fab fa-instagram"></i>
        <span>Instagram</span>
      </div>
      <div class="icon" data-window="whatsapp">
        <i class="fab fa-whatsapp"></i>
        <span>WhatsApp</span>
      </div>
      <div class="icon" data-window="linkedin">
        <i class="fab fa-linkedin"></i>
        <span>LinkedIn</span>
      </div>
    </div>
    
    <!-- Barra de tareas -->
    <div id="taskbar">
      <div class="start-button">
        <i class="fab fa-windows"></i>
      </div>
      <div class="task-list"></div>
      <div class="system-tray">
        <i class="fas fa-wifi"></i>
        <i class="fas fa-volume-up"></i>
        <i class="fas fa-battery-full"></i>
        <span class="time"></span>
      </div>
    </div>
  </div>
  
  <!-- Menú de inicio -->
  <div id="start-menu">
    <div class="apps-list">
      <div class="app-item">
        <i class="fas fa-user"></i>
        <span>Usuario</span>
      </div>
      <div class="app-item">
        <i class="fas fa-cog"></i>
        <span>Configuración</span>
      </div>
      <div class="app-item">
        <i class="fas fa-images"></i>
        <span>Imágenes</span>
      </div>
      <div class="app-item">
        <i class="fas fa-folder"></i>
        <span>Documentos</span>
      </div>
      <div class="app-item">
        <i class="fas fa-power-off"></i>
        <span>Apagar</span>
      </div>
    </div>
  </div>
  
  <script>
    class WindowsEmulator {
      constructor() {
        this.lockScreen = document.getElementById('lock-screen');
        this.desktop = document.getElementById('desktop');
        this.startMenu = document.getElementById('start-menu');
        this.startButton = document.querySelector('.start-button');
        this.taskList = document.querySelector('.task-list');
        this.systemTime = document.querySelectorAll('.time');
        this.dateElement = document.querySelector('.date');
        
        this.windows = new Map();
        this.zIndex = 100;
        
        this.init();
      }
    
      init() {
        this.setupLockScreen();
        this.setupClock();
        this.setupStartMenu();
        this.setupDesktopIcons();
        this.setupWindowDragging();
      }
    
      setupLockScreen() {
        const handleUnlock = (e) => {
          const touchEnd = e.type === 'touchend' ? e.changedTouches[0].clientY : e.clientY;
          if (this.touchStart - touchEnd > 100) {
            this.lockScreen.classList.remove('active');
          }
        };
    
        const handleTouchStart = (e) => {
          this.touchStart = e.type === 'touchstart' ? e.touches[0].clientY : e.clientY;
        };
    
        this.lockScreen.addEventListener('touchstart', handleTouchStart);
        this.lockScreen.addEventListener('mousedown', handleTouchStart);
        this.lockScreen.addEventListener('touchend', handleUnlock);
        this.lockScreen.addEventListener('mouseup', handleUnlock);
      }
    
      setupClock() {
        const updateClock = () => {
          const now = new Date();
          const timeString = now.toLocaleTimeString('es-ES', { hour: '2-digit', minute: '2-digit' });
          const dateString = now.toLocaleDateString('es-ES', { weekday: 'long', day: 'numeric', month: 'long' });
          this.systemTime.forEach(el => el.textContent = timeString);
          if (this.dateElement) {
            this.dateElement.textContent = dateString;
          }
        };
    
        updateClock();
        setInterval(updateClock, 1000);
      }
    
      setupStartMenu() {
        this.startButton.addEventListener('click', () => {
          this.startMenu.classList.toggle('show');
        });
    
        document.addEventListener('click', (e) => {
          if (!this.startMenu.contains(e.target) && !this.startButton.contains(e.target)) {
            this.startMenu.classList.remove('show');
          }
        });
      }
    
      setupDesktopIcons() {
        document.querySelectorAll('.icon').forEach(icon => {
          icon.addEventListener('click', () => {
            const windowType = icon.dataset.window;
            if (windowType === 'correo') {
              window.location.href = "mailto:informaticaivorra@gmail.com";
            } else if (windowType === 'instagram') {
              window.location.href = "https://www.instagram.com/seta_ivorra/";
            } else if (windowType === 'whatsapp') {
              window.location.href = "https://wa.me/34606192518";
            } else if (windowType === 'linkedin') {
              window.location.href = "https://www.linkedin.com/in/sergio-ivorra-puig-140079343/?original_referer=https%3A%2F%2Fsergioivorra.github.io%2F";
            } else {
              this.createWindow(windowType);
            }
          });
        });
      }
    
      createWindow(type) {
        const windowElem = document.createElement('div');
        windowElem.className = 'window';
        windowElem.style.top = '50px';
        windowElem.style.left = '50px';
        windowElem.style.width = '800px';
        windowElem.style.height = '600px';
        windowElem.style.zIndex = ++this.zIndex;
    
        const content = this.getWindowContent(type);
        windowElem.innerHTML = `
          <div class="window-header">
            <div class="window-title">${content.title}</div>
            <div class="window-controls">
              <div class="window-button minimize">
                <i class="fas fa-minus"></i>
              </div>
              <div class="window-button maximize">
                <i class="fas fa-expand"></i>
              </div>
              <div class="window-button close">
                <i class="fas fa-times"></i>
              </div>
            </div>
          </div>
          <div class="window-content">
            ${content.body}
          </div>
        `;
    
        this.desktop.appendChild(windowElem);
        this.setupWindowControls(windowElem);
        this.windows.set(windowElem, { type, minimized: false });
        this.updateTaskbar();
      }
    
      getWindowContent(type) {
        switch (type) {
          case 'youtube':
            return {
              title: 'YouTube',
              body: `
                <div style="width:100%; height:100%; display: flex; justify-content: center; align-items: center; background: #000;">
                  <iframe width="560" height="315" src="https://www.youtube.com/embed/6ih70eZuDAM?si=1pMWfyRFQ0c8IuOP" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
                </div>
              `
            };
          case 'browser':
            return {
              title: 'Microsoft Edge',
              body: `
                <div style="height: 100%; display: flex; flex-direction: column;">
                  <div style="padding: 8px; background: #f5f5f5; border-bottom: 1px solid #ddd; display: flex; gap: 8px; align-items: center;">
                    <div class="nav-buttons" style="display: flex; gap: 4px;">
                      <button>
                        <i class="fas fa-arrow-left"></i>
                      </button>
                      <button>
                        <i class="fas fa-arrow-right"></i>
                      </button>
                      <button>
                        <i class="fas fa-redo"></i>
                      </button>
                    </div>
                    <div style="flex: 1; display: flex; align-items: center; background: #fff; border-radius: 20px; padding: 6px 12px; border: 1px solid #ddd;">
                      <i class="fas fa-lock" style="font-size: 12px; color: #5f6368; margin-right: 8px;"></i>
                      <input type="text" value="https://www.google.com" style="border: none; outline: none; width: 100%; font-size: 14px;">
                    </div>
                  </div>
                  <div style="flex: 1; background: #fff;">
                    <iframe 
                      src="https://www.google.com/webhp?igu=1" 
                      style="width: 100%; height: 100%; border: none;"
                      sandbox="allow-same-origin allow-scripts allow-popups allow-forms"
                    ></iframe>
                  </div>
                </div>
              `
            };
          case 'explorer':
            return {
              title: 'Explorador de Archivos',
              body: `
                <div style="padding: 10px;">
                  <div style="display: flex; align-items: center; padding: 8px; border-bottom: 1px solid #eee;">
                    <i class="fas fa-arrow-left" style="margin-right: 15px; color: #666;"></i>
                    <i class="fas fa-arrow-right" style="margin-right: 15px; color: #666;"></i>
                    <input type="text" value="Este Equipo" style="flex: 1; padding: 5px; border: 1px solid #ddd; border-radius: 3px;">
                  </div>
                  <div style="display: flex; margin-top: 15px;">
                    <div style="width: 200px; padding-right: 15px; border-right: 1px solid #eee;">
                      <div style="padding: 8px; color: #333;">
                        <i class="fas fa-star" style="margin-right: 8px; color: #666;"></i> Acceso Rápido
                      </div>
                      <div style="padding: 8px; color: #333;">
                        <i class="fas fa-desktop" style="margin-right: 8px; color: #666;"></i> Este Equipo
                      </div>
                      <div style="padding: 8px; color: #333;">
                        <i class="fas fa-download" style="margin-right: 8px; color: #666;"></i> Descargas
                      </div>
                      <div style="padding: 8px; color: #333;">
                        <i class="fas fa-image" style="margin-right: 8px; color: #666;"></i> Imágenes
                      </div>
                      <div style="padding: 8px; color: #333;">
                        <i class="fas fa-music" style="margin-right: 8px; color: #666;"></i> Música
                      </div>
                      <div style="padding: 8px; color: #333;">
                        <i class="fas fa-video" style="margin-right: 8px; color: #666;"></i> Videos
                      </div>
                    </div>
                    <div style="flex: 1; padding-left: 15px;">
                      <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); gap: 15px;">
                        <div style="text-align: center; padding: 10px;">
                          <i class="fas fa-hdd" style="font-size: 24px; color: #0078D7; margin-bottom: 5px;"></i>
                          <div>Disco Local (C:)</div>
                        </div>
                        <div style="text-align: center; padding: 10px;">
                          <i class="fas fa-hdd" style="font-size: 24px; color: #0078D7; margin-bottom: 5px;"></i>
                          <div>Disco Local (D:)</div>
                        </div>
                        <div style="text-align: center; padding: 10px;">
                          <i class="fas fa-folder" style="font-size: 24px; color: #0078D7; margin-bottom: 5px;"></i>
                          <div>Nueva Carpeta</div>
                        </div>
                        <div style="text-align: center; padding: 10px;">
                          <i class="fas fa-file" style="font-size: 24px; color: #0078D7; margin-bottom: 5px;"></i>
                          <div>Nuevo Archivo</div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              `
            };
          case 'notepad':
            return {
              title: 'Bloc de Notas',
              body: `
                <div style="height: 100%; display: flex; flex-direction: column;">
                  <div style="padding: 5px; border-bottom: 1px solid #eee;">
                    <span style="margin-right: 15px; color: #666;">Archivo</span>
                    <span style="margin-right: 15px; color: #666;">Editar</span>
                    <span style="margin-right: 15px; color: #666;">Formato</span>
                    <span style="color: #666;">Ver</span>
                  </div>
                  <textarea style="flex: 1; padding: 10px; border: none; resize: none; outline: none; font-family: 'Consolas', monospace;"></textarea>
                </div>
              `
            };
          case 'calculator':
            return {
              title: 'Calculadora',
              body: `
                <div id="calculator-container" style="height: 100%; display: flex; flex-direction: column; background: #f7f7f7; padding: 20px;">
                  <input id="calc-display" type="text" readonly style="width: 100%; font-size: 32px; padding: 10px; text-align: right; margin-bottom: 10px; border: 1px solid #ddd; border-radius: 4px;">
                  <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px;">
                    <button class="calc-btn" data-value="7" style="padding: 20px; font-size: 20px;">7</button>
                    <button class="calc-btn" data-value="8" style="padding: 20px; font-size: 20px;">8</button>
                    <button class="calc-btn" data-value="9" style="padding: 20px; font-size: 20px;">9</button>
                    <button class="calc-btn" data-value="/" style="padding: 20px; font-size: 20px;">÷</button>
                    <button class="calc-btn" data-value="4" style="padding: 20px; font-size: 20px;">4</button>
                    <button class="calc-btn" data-value="5" style="padding: 20px; font-size: 20px;">5</button>
                    <button class="calc-btn" data-value="6" style="padding: 20px; font-size: 20px;">6</button>
                    <button class="calc-btn" data-value="*" style="padding: 20px; font-size: 20px;">×</button>
                    <button class="calc-btn" data-value="1" style="padding: 20px; font-size: 20px;">1</button>
                    <button class="calc-btn" data-value="2" style="padding: 20px; font-size: 20px;">2</button>
                    <button class="calc-btn" data-value="3" style="padding: 20px; font-size: 20px;">3</button>
                    <button class="calc-btn" data-value="-" style="padding: 20px; font-size: 20px;">−</button>
                    <button class="calc-btn" data-value="0" style="padding: 20px; font-size: 20px;">0</button>
                    <button class="calc-btn" data-value="." style="padding: 20px; font-size: 20px;">.</button>
                    <button class="calc-btn" data-value="C" style="padding: 20px; font-size: 20px;">C</button>
                    <button class="calc-btn" data-value="+" style="padding: 20px; font-size: 20px;">+</button>
                    <button class="calc-btn" data-value="=" style="grid-column: span 4; padding: 20px; font-size: 20px; background: #0078D7; color: white;">=</button>
                  </div>
                </div>
              `
            };
          case 'n64':
            return {
              title: 'Nintendo 64 - Super Mario 64',
              body: `
                <div style="height: 100%; display: flex; flex-direction: column; background: #1a1a1a; color: white;">
                  <div style="padding: 10px; background: #2a2a2a; border-bottom: 1px solid #333;">
                    <button id="start-game" style="padding: 8px 16px; background: #4a4a4a; color: white; border: none; border-radius: 4px; cursor: pointer;">
                      Jugar Super Mario 64
                    </button>
                  </div>
                  <div style="flex: 1; display: flex; justify-content: center; align-items: center; padding: 20px;">
                    <div id="emulator-container" style="width: 100%; height: 100%; display: flex; justify-content: center; align-items: center; position: relative;">
                      <div id="emulator" style="width: 100%; height: 100%; position: relative;">
                        <div class="loading-message">
                          Haz clic en "Jugar Super Mario 64" para comenzar a jugar...
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              `
            };
          case 'mariokart':
            return {
              title: 'Nintendo 64 - Mario Kart 64',
              body: `
                <div style="height: 100%; display: flex; flex-direction: column; background: #1a1a1a; color: white;">
                  <div style="padding: 10px; background: #2a2a2a; border-bottom: 1px solid #333;">
                    <button id="start-game" style="padding: 8px 16px; background: #4a4a4a; color: white; border: none; border-radius: 4px; cursor: pointer;">
                      Jugar Mario Kart 64
                    </button>
                  </div>
                  <div style="flex: 1; display: flex; justify-content: center; align-items: center; padding: 20px;">
                    <div id="emulator-container" style="width: 100%; height: 100%; display: flex; justify-content: center; align-items: center; position: relative;">
                      <div id="emulator" style="width: 100%; height: 100%; position: relative;">
                        <div class="loading-message">
                          Haz clic en "Jugar Mario Kart 64" para comenzar a jugar...
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              `
            };
          case 'settings':
            return {
              title: 'Configuración',
              body: `
                <div class="settings-container">
                  <div class="settings-header">Configuración del Sistema</div>
                  <div class="setting-item">
                    <label for="toggle-dark">Modo Oscuro</label>
                    <input type="checkbox" id="toggle-dark">
                  </div>
                  <div class="setting-item">
                    <label for="toggle-wifi">WiFi</label>
                    <input type="checkbox" id="toggle-wifi" checked>
                  </div>
                  <div class="setting-item">
                    <label for="toggle-bluetooth">Bluetooth</label>
                    <input type="checkbox" id="toggle-bluetooth">
                  </div>
                  <div class="setting-item">
                    <label for="brightness-range">Brillo</label>
                    <input type="range" id="brightness-range" min="0" max="100" value="80">
                  </div>
                  <div class="setting-item">
                    <label for="volume-range">Volumen</label>
                    <input type="range" id="volume-range" min="0" max="100" value="50">
                  </div>
                  <div class="setting-item">
                    <label for="toggle-dnd">No Molestar</label>
                    <input type="checkbox" id="toggle-dnd">
                  </div>
                  <div class="setting-item">
                    <label for="language-select">Idioma</label>
                    <select id="language-select">
                      <option value="es">Español</option>
                      <option value="en">Inglés</option>
                      <option value="pt">Portugués</option>
                    </select>
                  </div>
                  <div class="setting-item">
                    <label for="background-select">Fondo de Pantalla</label>
                    <select id="background-select">
                      <option value="https://picsum.photos/1920/1080?random=1">Paisaje 1</option>
                      <option value="https://picsum.photos/1920/1080?random=2">Paisaje 2</option>
                      <option value="https://picsum.photos/1920/1080?random=3">Paisaje 3</option>
                      <option value="https://picsum.photos/1920/1080?random=4">Paisaje 4</option>
                    </select>
                  </div>
                  <div class="setting-item">
                    <label for="theme-select">Tema</label>
                    <select id="theme-select">
                      <option value="light">Claro</option>
                      <option value="dark">Oscuro</option>
                    </select>
                  </div>
                </div>
              `
            };
          default:
            return {
              title: '',
              body: '<p></p>'
            };
        }
      }
    
      setupWindowControls(windowElem) {
        const header = windowElem.querySelector('.window-header');
        const closeBtn = windowElem.querySelector('.window-button.close');
        const minimizeBtn = windowElem.querySelector('.window-button.minimize');
        const maximizeBtn = windowElem.querySelector('.window-button.maximize');
    
        if (closeBtn) {
          closeBtn.addEventListener('click', () => {
            windowElem.remove();
            this.windows.delete(windowElem);
            this.updateTaskbar();
          });
        }
    
        if (minimizeBtn) {
          minimizeBtn.addEventListener('click', () => {
            windowElem.style.display = 'none';
            const windowData = this.windows.get(windowElem);
            if (windowData) {
              windowData.minimized = true;
              this.updateTaskbar();
            }
          });
        }
    
        if (maximizeBtn) {
          maximizeBtn.addEventListener('click', () => {
            if (windowElem.style.width === '100%') {
              windowElem.style.width = '';
              windowElem.style.height = '';
              windowElem.style.top = '50px';
              windowElem.style.left = '50px';
            } else {
              windowElem.style.width = '100%';
              windowElem.style.height = 'calc(100% - 48px)';
              windowElem.style.top = '0';
              windowElem.style.left = '0';
            }
          });
        }
    
        windowElem.addEventListener('mousedown', () => {
          windowElem.style.zIndex = ++this.zIndex;
        });
    
        const iframe = windowElem.querySelector('iframe');
        const navButtons = windowElem.querySelector('.nav-buttons');
        const urlInput = windowElem.querySelector('input[type="text"]');
    
        if (iframe && navButtons) {
          const backBtn = navButtons.querySelector('button:nth-child(1)');
          const forwardBtn = navButtons.querySelector('button:nth-child(2)');
          const reloadBtn = navButtons.querySelector('button:nth-child(3)');
    
          if (backBtn) {
            backBtn.addEventListener('click', () => {
              try {
                iframe.contentWindow.history.back();
              } catch (e) {
                console.log('No se puede retroceder');
              }
            });
          }
    
          if (forwardBtn) {
            forwardBtn.addEventListener('click', () => {
              try {
                iframe.contentWindow.history.forward();
              } catch (e) {
                console.log('No se puede avanzar');
              }
            });
          }
    
          if (reloadBtn) {
            reloadBtn.addEventListener('click', () => {
              iframe.src = iframe.src;
            });
          }
        }
    
        if (urlInput && iframe) {
          urlInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
              let url = urlInput.value;
              if (!url.startsWith('http://') && !url.startsWith('https://')) {
                url = 'https://' + url;
              }
              iframe.src = url;
            }
          });
        }
    
        // Inicializar la calculadora si es el tipo "calculator"
        if (this.windows.get(windowElem).type === 'calculator') {
          this.initCalculator(windowElem);
        }
    
        // Configuración para fondo y tema en la ventana de Configuración
        const backgroundSelect = windowElem.querySelector('#background-select');
        const themeSelect = windowElem.querySelector('#theme-select');
    
        if (backgroundSelect) {
          backgroundSelect.addEventListener('change', (e) => {
            const selectedBackground = e.target.value;
            this.desktop.style.backgroundImage = `linear-gradient(rgba(0,0,0,0.1), rgba(0,0,0,0.1)), url('${selectedBackground}') center/cover`;
          });
        }
    
        if (themeSelect) {
          themeSelect.addEventListener('change', (e) => {
            const selectedTheme = e.target.value;
            if (selectedTheme === 'dark') {
              document.body.style.background = '#121212';
              this.desktop.style.background = `linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url('https://picsum.photos/1920/1080?random=5') center/cover`;
              document.querySelectorAll('.window').forEach(win => {
                win.style.background = 'rgba(40,40,40,0.98)';
                win.querySelector('.window-header').style.background = '#333';
                win.querySelector('.window-title').style.color = '#fff';
              });
            } else {
              document.body.style.background = '#000';
              this.desktop.style.background = `linear-gradient(rgba(0,0,0,0.1), rgba(0,0,0,0.1)), url('https://picsum.photos/1920/1080?random=1') center/cover`;
              document.querySelectorAll('.window').forEach(win => {
                win.style.background = 'rgba(255,255,255,0.98)';
                win.querySelector('.window-header').style.background = '#f3f3f3';
                win.querySelector('.window-title').style.color = '#333';
              });
            }
          });
        }
      }
    
      initCalculator(windowElem) {
        const container = windowElem.querySelector('#calculator-container');
        if (!container) return;
        const display = container.querySelector('#calc-display');
        const buttons = container.querySelectorAll('.calc-btn');
        buttons.forEach(btn => {
          btn.addEventListener('click', () => {
            const value = btn.getAttribute('data-value');
            if (value === 'C') {
              display.value = '';
            } else if (value === '=') {
              try {
                display.value = eval(display.value);
              } catch (e) {
                display.value = 'Error';
              }
            } else {
              display.value += value;
            }
          });
        });
      }
    
      setupWindowDragging() {
        let isDragging = false;
        let currentX;
        let currentY;
        let initialX;
        let initialY;
        let xOffset = 0;
        let yOffset = 0;
        let activeWindow = null;
    
        document.addEventListener('mousedown', (e) => {
          if (e.target.closest('.window-header')) {
            activeWindow = e.target.closest('.window');
            isDragging = true;
            activeWindow.style.zIndex = ++this.zIndex;
            initialX = e.clientX - xOffset;
            initialY = e.clientY - yOffset;
          }
        });
    
        document.addEventListener('mousemove', (e) => {
          if (isDragging && activeWindow) {
            e.preventDefault();
            currentX = e.clientX - initialX;
            currentY = e.clientY - initialY;
            xOffset = currentX;
            yOffset = currentY;
            activeWindow.style.transform = `translate3d(${currentX}px, ${currentY}px, 0)`;
          }
        });
    
        document.addEventListener('mouseup', () => {
          if (isDragging && activeWindow) {
            activeWindow.style.top = `${yOffset}px`;
            activeWindow.style.left = `${xOffset}px`;
            activeWindow.style.transform = `translate3d(0,0,0)`;
            isDragging = false;
            activeWindow = null;
          }
        });
      }
    
      updateTaskbar() {
        this.taskList.innerHTML = '';
        this.windows.forEach((data, windowElem) => {
          const taskButton = document.createElement('div');
          taskButton.className = 'task-button';
          taskButton.innerHTML = `<i class="fas fa-window-maximize"></i> ${data.type.charAt(0).toUpperCase() + data.type.slice(1)}`;
          taskButton.addEventListener('click', () => {
            if (data.minimized) {
              windowElem.style.display = 'block';
              data.minimized = false;
              taskButton.classList.remove('active');
            } else {
              windowElem.style.display = 'none';
              data.minimized = true;
              taskButton.classList.add('active');
            }
          });
          this.taskList.appendChild(taskButton);
        });
      }
    }
    
    // Inicializar el emulador
    window.addEventListener('DOMContentLoaded', () => {
      new WindowsEmulator();
    });
  </script>
</body>
</html>
